#  Conjuntos de instrucciones SQL que se guardan en el servidor de bases de datos para ser reutilizados. 
#  Funcionan como programas o subrutinas que puedes ejecutar directamente desde la base de datos, lo que permite realizar operaciones complejas de manera eficiente, 
#  reduciendo la necesidad de escribir las mismas consultas repetidamente.

### Caracter칤sticas principales de los procedimientos almacenados:

1. Encapsulamiento de l칩gica: Permiten agrupar y reutilizar una serie de sentencias SQL, encapsulando la l칩gica de negocio en la base de datos.
   
2. Reutilizaci칩n: Pueden ejecutarse m칰ltiples veces con diferentes par치metros, evitando duplicar c칩digo y simplificando la administraci칩n.

3. Mejora en el rendimiento: Al ser almacenados en el servidor de bases de datos, 
   los procedimientos almacenados suelen ejecutarse m치s r치pidamente que las consultas ad hoc, ya que su plan de ejecuci칩n es optimizado y almacenado por el servidor.

4. Seguridad: Permiten controlar qu칠 usuarios pueden ejecutar determinadas operaciones en la base de datos, sin necesidad de otorgar acceso directo a las tablas subyacentes. Adem치s, ayudan a prevenir ataques de **inyecci칩n SQL**, al ser m치s dif칤cil manipular su l칩gica.

---

### 쮺칩mo crear un procedimiento almacenado en MySQL?

La sintaxis b치sica para crear un procedimiento almacenado en MySQL es la siguiente:

CREATE PROCEDURE nombre_procedimiento ([lista_de_parametros])
BEGIN
    -- Instrucciones SQL aqu칤
END;

- **`nombre_procedimiento`**: El nombre que le das al procedimiento.
- **`lista_de_parametros`**: Son los par치metros de entrada y salida que el procedimiento puede recibir o retornar.
- **`BEGIN...END`**: Delimita el bloque de c칩digo SQL dentro del procedimiento.

### Tipos de par치metros:
1. IN: Par치metro de entrada. Se pasa un valor al procedimiento cuando se llama.
2. OUT: Par치metro de salida. El procedimiento puede modificar este valor y devolverlo.
3. INOUT: Es tanto de entrada como de salida. Se pasa un valor al procedimiento y este puede modificarlo.

---

### Ejemplo de procedimiento almacenado en MySQL

Supongamos que tenemos una tabla `Usuarios` y queremos crear un procedimiento que inserte un nuevo usuario. 
El procedimiento recibir치 como par치metros el nombre y el correo electr칩nico del usuario.

CREATE PROCEDURE InsertarUsuario(IN nombre VARCHAR(100), IN email VARCHAR(100))
BEGIN
    INSERT INTO Usuarios (Nombre, Email)
    VALUES (nombre, email);
END;

Aqu칤 se est치 creando un procedimiento llamado `InsertarUsuario`, que toma dos par치metros de entrada (`nombre` y `email`). C
uando se ejecuta, inserta un nuevo registro en la tabla `Usuarios`.

### Llamar a un procedimiento almacenado

Para ejecutar el procedimiento `InsertarUsuario`, usas el comando `CALL`:

CALL InsertarUsuario('Ana Garc칤a', 'ana.garcia@example.com');
```
Esto agregar치 un nuevo usuario con el nombre "Ana Garc칤a" y el correo "ana.garcia@example.com".

### Ejemplo con par치metros de salida

Veamos un ejemplo donde el procedimiento retorna un valor usando un par치metro `OUT`. Supongamos que queremos obtener la cantidad de usuarios en la tabla `Usuarios`.

CREATE PROCEDURE ContarUsuarios(OUT total INT)
BEGIN
    SELECT COUNT(*) INTO total FROM Usuarios;
END;
```
Este procedimiento `ContarUsuarios` usa un par치metro de salida (`total`) para devolver la cantidad de usuarios en la tabla.

Para ejecutarlo y obtener el valor devuelto:

CALL ContarUsuarios(@cantidad);
SELECT @cantidad AS TotalUsuarios;
```

Aqu칤, el valor de la variable `@cantidad` contendr치 el total de usuarios.

---

### Beneficios de los procedimientos almacenados:

1. Rendimiento: Como el procedimiento est치 precompilado y almacenado en el servidor, se ejecuta m치s r치pido que consultas din치micas que se env칤an desde la aplicaci칩n.
   
2. Modularidad: Permiten organizar la l칩gica de la base de datos en unidades manejables y reutilizables.

3. Reducci칩n del tr치fico entre cliente-servidor: En lugar de enviar m칰ltiples consultas individuales, 
                                                 puedes llamar a un procedimiento almacenado que ejecute todo en el servidor.

4. Mantenimiento: Si la l칩gica cambia, solo necesitas modificar el procedimiento almacenado y no las aplicaciones cliente.

5. Seguridad: Facilitan la implementaci칩n de reglas de seguridad, permitiendo que los usuarios ejecuten procedimientos almacenados 
              sin tener acceso directo a las tablas subyacentes.

---

### Limitaciones o inconvenientes:
- Dependencia de la base de datos**: Los procedimientos almacenados son espec칤ficos del sistema de bases de datos que utilices (MySQL, PostgreSQL, SQL Server, etc.). Esto puede generar problemas de portabilidad si cambias de sistema.
- Complejidad: Para aplicaciones peque침as o sencillas, los procedimientos almacenados pueden ser innecesarios y a침adir complejidad.
- Dif칤cil de depurar: A veces, depurar procedimientos almacenados es m치s complicado que depurar c칩digo de aplicaci칩n tradicional.

---

### Ejemplo m치s avanzado: Procedimiento con control de flujo

Adem치s de ejecutar consultas simples, los procedimientos almacenados pueden incluir estructuras de control de flujo, como condiciones (`IF`), ciclos (`WHILE`, `LOOP`), y manejo de excepciones.

```sql
CREATE PROCEDURE ActualizarEmailUsuario(IN id INT, IN nuevo_email VARCHAR(100))
BEGIN
    DECLARE usuario_existe INT;
    
    -- Verificar si el usuario existe
    SELECT COUNT(*) INTO usuario_existe FROM Usuarios WHERE ID_Usuario = id;
    
    -- Si el usuario existe, actualizamos su email
    IF usuario_existe > 0 THEN
        UPDATE Usuarios
        SET Email = nuevo_email
        WHERE ID_Usuario = id;
    ELSE
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Usuario no encontrado';
    END IF;
END;
```

Este procedimiento `ActualizarEmailUsuario` verifica si un usuario con un determinado `ID` existe. Si es as칤, actualiza su correo electr칩nico, y si no, lanza un error personalizado.

---

### Resumen:
九덢잺 Los **procedimientos almacenados** son una herramienta poderosa que permite encapsular l칩gica SQL dentro de la base de datos.  
九덢잺 Ofrecen **mejora de rendimiento**, **seguridad** y **reutilizaci칩n del c칩digo**.  
九덢잺 Pueden tener **par치metros de entrada** y **de salida**, y tambi칠n soportan **control de flujo**.

Si tienes alguna duda adicional sobre c칩mo trabajar con procedimientos almacenados o necesitas m치s ejemplos, 춰solo av칤same! 游땕
